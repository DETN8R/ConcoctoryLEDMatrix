//

#include "Tlc5940.h"
//#DEFINE brightness 4095
int matrixWidth = 16;
int matrixHeight = 5;
int old_val = 0;
int new_val =0;
int led[16][5] = {
	{0 , 16, 32, 48, 64},
	{1 , 17, 33, 49, 65},
	{2 , 18, 34, 50, 66},
	{3 , 19, 35, 51, 67},
	{4 , 20, 36, 52, 68},
	{5 , 21, 37, 53, 69},
	{6 , 22, 38, 54, 70},
	{7 , 23, 39, 55, 71},
	{8 , 24, 40, 56, 72},
	{9 , 25, 41, 57, 73},
	{10, 26, 42, 58, 74},
	{11, 27, 43, 59, 75},
	{12, 28, 44, 60, 76},
	{13, 29, 45, 61, 77},
	{14, 30, 46, 62, 78},
	{15, 31, 47, 63, 79}
};
int led_buffer[48][5];


int led_brightness[16][5];


const int letter_A[5][5] = {
	{0,4095,4095,4095,0},
	{4095,0,0,0,4095},
	{4095,4095,4095,4095,4095},
	{4095,0,0,0,4095},
	{4095,0,0,0,4095}
};

const int letter_B[5][5] = {
	{4095,4095,4095,4095,0},
	{4095,0,0,0,4095},
	{4095,4095,4095,4095,0},
	{4095,0,0,0,4095},
	{4095,4095,4095,4095,0}
};

const int letter_C[5][5] = {
	{0,4095,4095,4095,4095},
	{4095,0,0,0,0},
	{4095,0,0,0,0},
	{4095,0,0,0,0},
	{0,4095,4095,4095,4095}
};

const int letter_D[5][5] = {
	{4095,4095,4095,4095,0},
	{4095,0,0,0,4095},
	{4095,0,0,0,4095},
	{4095,0,0,0,4095},
	{4095,4095,4095,4095,0}
};

const int letter_E[5][5] = {
	{4095,4095,4095,4095,4095},
	{4095,0,0,0,0},
	{4095,4095,4095,4095,0},
	{4095,0,0,0,0},
	{4095,4095,4095,4095,4095}
};
const int letter_F[5][5] = {
	{4095,4095,4095,4095,4095},
	{4095,0,0,0,0},
	{4095,4095,4095,4095,0},
	{4095,0,0,0,0},
	{4095,0,0,0,0}
};

const int letter_G[5][5] = {
	{0,4095,4095,4095,4095},
	{4095,0,0,0,0},
	{4095,0,4095,4095,0},
	{4095,0,0,0,4095},
	{0,4095,4095,4095,0}
};
const int letter_H[5][5] = {
	{4095,0,0,0,4095},
	{4095,0,0,0,4095},
	{4095,4095,4095,4095,4095},
	{4095,0,0,0,4095},
	{4095,0,0,0,4095}
};
const int letter_I[5][5] = {
	{4095,4095,4095,4095,4095},
	{0,0,4095,0,0},
	{0,0,4095,0,0},
	{0,0,4095,0,0},
	{4095,4095,4095,4095,4095}
};
const int letter_J[5][5] = {
	{0,0,0,0,4095},
	{0,0,0,0,4095},
	{4095,0,0,0,4095},
	{4095,0,0,0,4095},
	{0,4095,4095,4095,0}
};
const int letter_K[5][5] = {
	{4095,0,0,0,4095},
	{4095,0,0,4095,0},
	{4095,4095,4095,0,0},
	{4095,0,0,4095,0},
	{4095,0,0,0,4095}
};
const int letter_L[5][5] = {
	{4095,0,0,0,0},
	{4095,0,0,0,0},
	{4095,0,0,0,0},
	{4095,0,0,0,0},
	{4095,4095,4095,4095,4095}
};
const int letter_M[5][5] = {
	{4095,0,0,0,4095},
	{4095,4095,0,4095,4095},
	{4095,0,4095,0,4095},
	{4095,0,0,0,4095},
	{4095,0,0,0,4095}
};
const int letter_N[5][5] = {
	{4095,0,0,0,4095},
	{4095,4095,0,0,4095},
	{4095,0,4095,0,4095},
	{4095,0,0,4095,4095},
	{4095,0,0,0,4095}
};
const int letter_O[5][5] = {
	{0,4095,4095,4095,0},
	{4095,0,0,0,4095},
	{4095,0,0,0,4095},
	{4095,0,0,0,4095},
	{0,4095,4095,4095,0}
};
const int letter_P[5][5] = {
	{4095,4095,4095,4095,0},
	{4095,0,0,0,4095},
	{4095,0,0,0,4095},
	{4095,4095,4095,4095,0},
	{4095,0,0,0,0}
};
const int letter_Q[5][5] = {
	{0,4095,4095,0,0},
	{4095,0,0,4095,0},
	{4095,0,0,4095,0},
	{4095,0,4095,4095,0},
	{0,4095,4095,0,4095}
};
const int letter_R[5][5] = {
	{4095,4095,4095,4095,0},
	{4095,0,0,0,4095},
	{4095,4095,4095,4095,0},
	{4095,0,0,0,4095},
	{4095,0,0,0,4095}
};
const int letter_S[5][5] = {
	{0,4095,4095,4095,4095},
	{4095,0,0,0,0},
	{0,4095,4095,4095,0},
	{0,0,0,0,4095},
	{4095,4095,4095,4095,0}
};
const int letter_T[5][5] = {
	{4095,4095,4095,4095,4095},
	{0,0,4095,0,0},
	{0,0,4095,0,0},
	{0,0,4095,0,0},
	{0,0,4095,0,0}
};
const int letter_U[5][5] = {
	{4095,0,0,0,4095},
	{4095,0,0,0,4095},
	{4095,0,0,0,4095},
	{4095,0,0,0,4095},
	{0,4095,4095,4095,0}
};
const int letter_V[5][5] = {
	{4095,0,0,0,4095},
	{4095,0,0,0,4095},
	{4095,0,0,0,4095},
	{0,4095,0,4095,0},
	{0,0,4095,0,0}
};
const int letter_W[5][5] = {
	{4095,0,0,0,4095},
	{4095,0,0,0,4095},
	{4095,0,0,0,4095},
	{4095,4095,0,4095,4095},
	{4095,0,4095,0,4095}
};
const int letter_X[5][5] = {
	{4095,0,0,0,4095},
	{0,4095,0,4095,0},
	{0,0,4095,0,0},
	{0,4095,0,4095,0},
	{4095,0,0,0,4095}
};
const int letter_Y[5][5] = {
	{4095,0,0,0,4095},
	{0,4095,0,4095,0},
	{0,0,4095,0,0},
	{0,0,4095,0,0},
	{0,0,4095,0,0}
};
const int letter_Z[5][5] = {
	{4095,4095,4095,4095,4095},
	{0,0,0,4095,0},
	{0,0,4095,0,0},
	{0,4095,0,0,0},
	{4095,4095,4095,4095,4095}
};


void setup()
{
  // Call Tlc.init() to setup the tlc.
   
  Tlc.init();
  Tlc.clear();
  
  
  
  Serial.begin(19200);
  vfdClear();
  
  
  
	for (int i = 0; i < 16; i++) {
		for (int s = 0; s < 5; s++) {
			led_brightness[i][s] = 0;
		}
	}
  //test letter
  for (int j = 0; j < 5; j++) { //for each column in the LED MATRIX
		for (int k = 0; k < 5; k++) { // for each LED in the column
			Tlc.set(led[15-k][4-j], letter_A[j][k]);
			led_brightness[15-k][4-j] = letter_A[j][k];
			vfdPos(3,1);
			Serial.print(j);
			vfdPos(4,1);
			Serial.print(k);
			vfdPos(1,1);
			Serial.print(led_brightness[15-k][4-j]);
			Serial.write("     ");
			delay(250);
		Tlc.update();
		}
		
	}
	Tlc.update();
	delay(2000);
}
void readBuffer() {
	



}




/* This loop will create a Knight Rider-like effect if you have LEDs plugged
   into all the TLC outputs.  NUM_TLCS is defined in "tlc_config.h" in the
   library folder.  After editing tlc_config.h for your setup, delete the
   Tlc5940.o file to save the changes. */

void loop()
{
	vfdPos(1,1);
	Serial.write("TEST123");
	vfdPos(1,2);
	Serial.write("Second Line");
	for (int s = 4; s >= 0; s--) {
	for (int i = 15; i >= 0; i--) {
		
			old_val = led_brightness[i][s];
			
			led_brightness[i][s] = 0;
			
			Tlc.set(led[i][s], led_brightness[i][s]);
			
			led_brightness[i-1][s] = old_val;
			
			Tlc.set(led[i-1][s], led_brightness[i-1][s]);
			
			Tlc.update();	
			vfdPos(1,3);
			Serial.write("Column: ");
			Serial.print(i);
			Serial.write(" ");
			vfdPos(1, 4);
			Serial.write("Row: ");
			Serial.print(s);
			vfdPos(10, 4);
			Serial.print(old_val);
			Serial.write(" ");
			Serial.print(led_brightness[i+1][s]);
			Serial.write("      ");
			delay(250);
		}			
	}
	
	/*for (int d = 0; d < 80; d++) {
		Tlc.set(d, 4095	);
		Tlc.update();
		delay(20);
	}*/
	
}



void vfdClear() {
	Serial.write(254);
	Serial.write(88);
}
void vfdPos(int column, int row) {
	Serial.write(254);
	Serial.write(71);
	Serial.write(column);
	Serial.write(row);
}

//int 


